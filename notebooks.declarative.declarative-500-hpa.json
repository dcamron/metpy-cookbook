{"version":2,"kind":"Notebook","sha256":"746a74fadeacd3e8bf452cbb819d9ca36f4d54ea2d617d0e34c30e553921daaf","slug":"notebooks.declarative.declarative-500-hpa","location":"/notebooks/declarative/declarative_500_hPa.ipynb","dependencies":[],"frontmatter":{"title":"Declarative 500-hPa Absolute Vorticity","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"MetPy Maintainers","given":"MetPy","family":"Maintainers"},"name":"MetPy Maintainers","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/metpy-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/projectpythia/metpy-cookbook/blob/main/notebooks/declarative/declarative_500_hPa.ipynb","exports":[{"format":"ipynb","filename":"declarative_500_hPa.ipynb","url":"/metpy-cookbook/build/declarative_500_hPa-e00d53fd767c16c0f032012cc49cfe4d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"By: Kevin Goebbert","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qttaPCu7J3"}],"key":"rCevoqEJs7"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This example uses the declarative syntax available through the MetPy package to allow a more convenient method for creating simple maps of atmospheric data. To plot aboslute vorticity, the data is scaled and reassigned to the xarray object for use in the declarative plotting interface.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"emZsq1KOsm"}],"key":"u7mAtT0Tub"}],"key":"gYA5pHhueK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from datetime import datetime\n\nimport xarray as xr\n\nfrom metpy.plots import declarative\nfrom metpy.units import units","key":"Q0qKfUCf8c"},{"type":"output","id":"TU5jQdVMSIMKDva0E6My4","data":[],"key":"K9AXtuotK1"}],"key":"DHNk5VVYC3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set date for desired dataset\ndt = datetime(2012, 10, 31, 12)\n\n# Open dataset from NCEI\nds = xr.open_dataset('https://www.ncei.noaa.gov/thredds/dodsC/'\n                     f'model-gfs-g4-anl-files-old/{dt:%Y%m}/{dt:%Y%m%d}/'\n                     f'gfsanl_4_{dt:%Y%m%d}_{dt:%H}00_000.grb2'\n                     ).metpy.parse_cf()\n\n# Subset Data to be just over CONUS\nds_us = ds.sel(lon=slice(360-160, 360-40), lat=slice(65, 10))","key":"mt1whcZW2T"},{"type":"output","id":"mZT4ooc0DpRa4b-LkddWA","data":[],"key":"imYgw9rudv"}],"key":"zMZ7E9LVys"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Contour Intervals","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"porKbCt7RZ"}],"identifier":"contour-intervals","label":"Contour Intervals","html_id":"contour-intervals","implicit":true,"key":"uTHmrkViYP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Since absolute vorticity rarely goes below zero in the Northern Hemisphere, we can set up a list of contour levels that doesnâ€™t include values near but greater than zero. The following code yields a list containing: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E0L6qkZAFJ"},{"type":"inlineCode","value":"[-8, -7, -6, -5, -4, -3, -2, -1, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a9dTxM0pPk"}],"key":"YB4EvtzrbN"}],"key":"WUy8AVWUJT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Absolute Vorticity colors\n# Use two different colormaps from matplotlib and combine into one color set\nclevs_500_avor = list(range(-8, 1, 1))+list(range(8, 46, 1))","key":"f6fTXBehmm"},{"type":"output","id":"qME7R9kqSOFe6LI6cv4ZZ","data":[],"key":"B4srlxoV5C"}],"key":"Zu4FfFQtsT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JJAvFsJ0mA"}],"identifier":"the-plot","label":"The Plot","html_id":"the-plot","implicit":true,"key":"jZ31lS5QkU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Using the declarative interface in MetPy to plot the 500-hPa Geopotential Heights and Absolute Vorticity.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RX4agyVQOE"}],"key":"y37WNC5cZu"}],"key":"fvjh7BlIcz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set Contour Plot Parameters\ncontour = declarative.ContourPlot()\ncontour.data = ds_us\ncontour.time = dt\ncontour.field = 'Geopotential_height_isobaric'\ncontour.level = 500 * units.hPa\ncontour.linecolor = 'black'\ncontour.linestyle = '-'\ncontour.linewidth = 2\ncontour.clabels = True\ncontour.contours = list(range(0, 20000, 60))\n\n# Set Color-filled Contour Parameters\ncfill = declarative.FilledContourPlot()\ncfill.data = ds_us\ncfill.time = dt\ncfill.field = 'Absolute_vorticity_isobaric'\ncfill.level = 500 * units.hPa\ncfill.contours = clevs_500_avor\ncfill.colormap = 'PuOr_r'\ncfill.image_range = (-45, 45)\ncfill.colorbar = 'horizontal'\ncfill.scale = 1e5\n\n# Panel for plot with Map features\npanel = declarative.MapPanel()\npanel.layout = (1, 1, 1)\npanel.area = 'uslcc'\npanel.projection = 'area'\npanel.layers = ['coastline', 'states', 'borders']\npanel.layers_edgecolor = ['black', 'grey', 'black']\npanel.layers_linewidth = [1.25, .75, 1]\npanel.title = (f'{cfill.level} GFS Geopotential Heights'\n               f'and Absolute Vorticity at {dt}')\npanel.plots = [cfill, contour]\n\n# Bringing it all together\npc = declarative.PanelContainer()\npc.size = (15, 14)\npc.panels = [panel]\n\npc.show()","key":"R7KMZ9fuu3"},{"type":"output","id":"VMEH0nNXFKUsJtWrZFUg5","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"11a299d22ec0a0ced8efe889e222c1e8","path":"/metpy-cookbook/build/11a299d22ec0a0ced8efe889e222c1e8.png"}}}],"key":"ou6A4aSLAS"}],"key":"m9oJBuz9fx"}],"key":"c2wvpGrYqv"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"MetPy Declarative - 300 hPa","url":"/notebooks/declarative/declarative-300hpa","group":"The MetPy Gallery"}}},"domain":"http://localhost:3000"}