{"version":2,"kind":"Notebook","sha256":"5914488c4b66f0a83cd42aad25b67ea85c591199e07048d37bc5274702c10714","slug":"notebooks.synoptic.geostrophic-wind-and-few-more","location":"/notebooks/synoptic/Geostrophic_Wind_And_Few_More.ipynb","dependencies":[],"frontmatter":{"title":"Geostrophic Wind and Other Calcuations","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"MetPy Maintainers","given":"MetPy","family":"Maintainers"},"name":"MetPy Maintainers","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/metpy-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/projectpythia/metpy-cookbook/blob/main/notebooks/synoptic/Geostrophic_Wind_And_Few_More.ipynb","exports":[{"format":"ipynb","filename":"Geostrophic_Wind_And_Few_More.ipynb","url":"/metpy-cookbook/build/Geostrophic_Wind_And-5235accad01078621d58fb2c41770873.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"cell_marker":"\"\"\"","lines_to_next_cell":0},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Demonstrate a variety of calculations in MetPy.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yFUIoArYlD"}],"key":"JFQp9hg7xY"}],"key":"LwthqC1w4B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import metpy.calc as mpcalc\nimport xarray as xr\nimport numpy as np\nfrom metpy.calc import geostrophic_wind\nfrom metpy.calc import q_vector\nfrom metpy.units import units\nimport matplotlib.pyplot as plt\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\nfrom scipy.ndimage.filters import gaussian_filter","key":"mGzeoJmDx2"},{"type":"output","id":"acMudAU8ElcwTmvDfvx6U","data":[{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_3608/2639708157.py:10: DeprecationWarning: Please import `gaussian_filter` from the `scipy.ndimage` namespace; the `scipy.ndimage.filters` namespace is deprecated and will be removed in SciPy 2.0.0.\n  from scipy.ndimage.filters import gaussian_filter\n"}],"key":"ZSTqdZSyIn"}],"key":"MyD0FnGTwa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"## opening NetCDF file using xarray \n\nds = xr.open_dataset(\"../convective/NETCDF_FILE.nc\", decode_times=True)","key":"ga5tGPl1Sx"},{"type":"output","id":"EcvpULzQHR5yIKorpnrSd","data":[],"key":"zZhp8cFpQb"}],"key":"fueGIFqDFB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds","key":"peIUt91NCk"},{"type":"output","id":"idl5a9SSTU5Vntj4HlvtV","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 2MB\nDimensions:  (time: 1, lev: 23, lat: 41, lon: 71)\nCoordinates:\n  * time     (time) datetime64[ns] 8B 2019-06-08\n  * lon      (lon) float64 568B -130.5 -129.5 -128.5 ... -62.5 -61.5 -60.5\n  * lat      (lat) float64 328B 20.5 21.5 22.5 23.5 24.5 ... 57.5 58.5 59.5 60.5\n  * lev      (lev) float64 184B 1e+03 975.0 950.0 925.0 ... 300.0 250.0 200.0\nData variables:\n    H        (time, lev, lat, lon) float32 268kB ...\n    OMEGA    (time, lev, lat, lon) float32 268kB ...\n    PS       (time, lat, lon) float32 12kB ...\n    QV       (time, lev, lat, lon) float32 268kB ...\n    SLP      (time, lat, lon) float32 12kB ...\n    T        (time, lev, lat, lon) float32 268kB ...\n    U        (time, lev, lat, lon) float32 268kB ...\n    V        (time, lev, lat, lon) float32 268kB ...\nAttributes: (12/33)\n    CDI:                               Climate Data Interface version 1.9.8 (...\n    Conventions:                       CF-1\n    History:                           Original file generated: Tue Jun 18 21...\n    Comment:                           GMAO filename: d5124_m2_jan10.inst3_3d...\n    Filename:                          MERRA2_400.inst3_3d_asm_Np.20190608.nc4\n    Institution:                       NASA Global Modeling and Assimilation ...\n    ...                                ...\n    RangeBeginningTime:                00:00:00.000000\n    RangeEndingDate:                   2019-06-08\n    RangeEndingTime:                   21:00:00.000000\n    history_L34RS:                     'Created by L34RS v1.4.3 @ NASA GES DI...\n    CDO:                               Climate Data Operators version 1.9.8 (...\n    cdo_openmp_thread_number:          12","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"6a130e76b1c0c20ec17a57d50b74ecf3","path":"/metpy-cookbook/build/6a130e76b1c0c20ec17a57d50b74ecf3.html"}}}],"key":"LN7vLAOIhd"}],"key":"ErIQ86HplL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#### making a function to slice the xarray dataset according to our need.\ndef slicer (data,lat1, lat2, lon1, lon2, time1,time2) :\n    sliced_data = data.sel(lat =slice(lat1, lat2), lon = slice(lon1, lon2),time = slice(time1, time2))\n    return sliced_data","key":"Bo6342geyw"},{"type":"output","id":"Jc1oztiHorSiSEMNJ9ZH0","data":[],"key":"tQynIF2aRn"}],"key":"l72UDs2ORV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#slicing the data for CONUS only\n\nnew_data = slicer(ds,23.5,50.5,-125.5,-66.5, ds.time[0], ds.time[0])","key":"DLZHYpqVpr"},{"type":"output","id":"UEsGhwlrwqBL-WWmW9lpg","data":[],"key":"dTXvsykJIl"}],"key":"vOOTXzT6Xk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"new_data","key":"aFeHzYQbks"},{"type":"output","id":"-kZuzUhouOemmqFmsLG7f","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 942kB\nDimensions:  (time: 1, lev: 23, lat: 28, lon: 60)\nCoordinates:\n  * time     (time) datetime64[ns] 8B 2019-06-08\n  * lon      (lon) float64 480B -125.5 -124.5 -123.5 ... -68.5 -67.5 -66.5\n  * lat      (lat) float64 224B 23.5 24.5 25.5 26.5 27.5 ... 47.5 48.5 49.5 50.5\n  * lev      (lev) float64 184B 1e+03 975.0 950.0 925.0 ... 300.0 250.0 200.0\nData variables:\n    H        (time, lev, lat, lon) float32 155kB ...\n    OMEGA    (time, lev, lat, lon) float32 155kB ...\n    PS       (time, lat, lon) float32 7kB ...\n    QV       (time, lev, lat, lon) float32 155kB ...\n    SLP      (time, lat, lon) float32 7kB ...\n    T        (time, lev, lat, lon) float32 155kB ...\n    U        (time, lev, lat, lon) float32 155kB ...\n    V        (time, lev, lat, lon) float32 155kB ...\nAttributes: (12/33)\n    CDI:                               Climate Data Interface version 1.9.8 (...\n    Conventions:                       CF-1\n    History:                           Original file generated: Tue Jun 18 21...\n    Comment:                           GMAO filename: d5124_m2_jan10.inst3_3d...\n    Filename:                          MERRA2_400.inst3_3d_asm_Np.20190608.nc4\n    Institution:                       NASA Global Modeling and Assimilation ...\n    ...                                ...\n    RangeBeginningTime:                00:00:00.000000\n    RangeEndingDate:                   2019-06-08\n    RangeEndingTime:                   21:00:00.000000\n    history_L34RS:                     'Created by L34RS v1.4.3 @ NASA GES DI...\n    CDO:                               Climate Data Operators version 1.9.8 (...\n    cdo_openmp_thread_number:          12","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"29136f0027f2f3548327743446dca3bb","path":"/metpy-cookbook/build/29136f0027f2f3548327743446dca3bb.html"}}}],"key":"omcTC1Qhe8"}],"key":"n2SAAPGGyo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"###extracting temperature, pressure, and geopotential from the dataset\ngph = new_data.H\np =new_data.lev\nT = new_data.T","key":"pHFCkhD7eB"},{"type":"output","id":"6tgf643b7muKuMM_cABJD","data":[],"key":"j6ZdyqOuxz"}],"key":"nmRhSxbO3n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gph","key":"GnW5Xy5ldY"},{"type":"output","id":"X0oCmeuA2ZSIFfpTl9OZp","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"<xarray.DataArray 'H' (time: 1, lev: 23, lat: 28, lon: 60)> Size: 155kB\n[38640 values with dtype=float32]\nCoordinates:\n  * time     (time) datetime64[ns] 8B 2019-06-08\n  * lon      (lon) float64 480B -125.5 -124.5 -123.5 ... -68.5 -67.5 -66.5\n  * lat      (lat) float64 224B 23.5 24.5 25.5 26.5 27.5 ... 47.5 48.5 49.5 50.5\n  * lev      (lev) float64 184B 1e+03 975.0 950.0 925.0 ... 300.0 250.0 200.0\nAttributes:\n    standard_name:   edge_heights\n    long_name:       edge_heights\n    units:           m\n    fmissing_value:  1e+15\n    vmax:            1e+15\n    vmin:            -1e+15","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;H&#x27; (time: 1, lev: 23, lat: 28, lon: 60)&gt; Size: 155kB\n[38640 values with dtype=float32]\nCoordinates:\n  * time     (time) datetime64[ns] 8B 2019-06-08\n  * lon      (lon) float64 480B -125.5 -124.5 -123.5 ... -68.5 -67.5 -66.5\n  * lat      (lat) float64 224B 23.5 24.5 25.5 26.5 27.5 ... 47.5 48.5 49.5 50.5\n  * lev      (lev) float64 184B 1e+03 975.0 950.0 925.0 ... 300.0 250.0 200.0\nAttributes:\n    standard_name:   edge_heights\n    long_name:       edge_heights\n    units:           m\n    fmissing_value:  1e+15\n    vmax:            1e+15\n    vmin:            -1e+15</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'H'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li><li><span class='xr-has-index'>lev</span>: 23</li><li><span class='xr-has-index'>lat</span>: 28</li><li><span class='xr-has-index'>lon</span>: 60</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-5882e390-321d-46a7-a517-8f3c24f0e732' class='xr-array-in' type='checkbox' checked><label for='section-5882e390-321d-46a7-a517-8f3c24f0e732' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[38640 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-153ea944-53a7-406e-b49e-8f0878c9c65a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-153ea944-53a7-406e-b49e-8f0878c9c65a' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-06-08</div><input id='attrs-30cdc1d7-e177-493c-830a-f20c5e51b033' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-30cdc1d7-e177-493c-830a-f20c5e51b033' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-05d15bff-7b41-45fe-8645-0a8051ecb4af' class='xr-var-data-in' type='checkbox'><label for='data-05d15bff-7b41-45fe-8645-0a8051ecb4af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-06-08T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-125.5 -124.5 ... -67.5 -66.5</div><input id='attrs-a7bcb585-4c44-467d-aa98-42639295d944' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a7bcb585-4c44-467d-aa98-42639295d944' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e9db35d7-ff55-484f-b892-75e996314c5f' class='xr-var-data-in' type='checkbox'><label for='data-e9db35d7-ff55-484f-b892-75e996314c5f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-125.5, -124.5, -123.5, -122.5, -121.5, -120.5, -119.5, -118.5, -117.5,\n       -116.5, -115.5, -114.5, -113.5, -112.5, -111.5, -110.5, -109.5, -108.5,\n       -107.5, -106.5, -105.5, -104.5, -103.5, -102.5, -101.5, -100.5,  -99.5,\n        -98.5,  -97.5,  -96.5,  -95.5,  -94.5,  -93.5,  -92.5,  -91.5,  -90.5,\n        -89.5,  -88.5,  -87.5,  -86.5,  -85.5,  -84.5,  -83.5,  -82.5,  -81.5,\n        -80.5,  -79.5,  -78.5,  -77.5,  -76.5,  -75.5,  -74.5,  -73.5,  -72.5,\n        -71.5,  -70.5,  -69.5,  -68.5,  -67.5,  -66.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>23.5 24.5 25.5 ... 48.5 49.5 50.5</div><input id='attrs-68a22ee0-27a0-4621-b063-8473622b740e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-68a22ee0-27a0-4621-b063-8473622b740e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6d08f191-e42c-47c9-96ac-fe4d297f7ace' class='xr-var-data-in' type='checkbox'><label for='data-6d08f191-e42c-47c9-96ac-fe4d297f7ace' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([23.5, 24.5, 25.5, 26.5, 27.5, 28.5, 29.5, 30.5, 31.5, 32.5, 33.5, 34.5,\n       35.5, 36.5, 37.5, 38.5, 39.5, 40.5, 41.5, 42.5, 43.5, 44.5, 45.5, 46.5,\n       47.5, 48.5, 49.5, 50.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03 975.0 950.0 ... 250.0 200.0</div><input id='attrs-c027cfd3-e731-4907-9eb7-910ad4b3c1e3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c027cfd3-e731-4907-9eb7-910ad4b3c1e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71aa72a0-efea-4209-82aa-5ec451d360bb' class='xr-var-data-in' type='checkbox'><label for='data-71aa72a0-efea-4209-82aa-5ec451d360bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>PLE_level</dd><dt><span>long_name :</span></dt><dd>vertical level</dd><dt><span>units :</span></dt><dd>hPa</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>coordinate :</span></dt><dd>PLE</dd><dt><span>vmax :</span></dt><dd>1e+15</dd><dt><span>vmin :</span></dt><dd>-1e+15</dd></dl></div><div class='xr-var-data'><pre>array([1000.,  975.,  950.,  925.,  900.,  875.,  850.,  825.,  800.,  775.,\n        750.,  725.,  700.,  650.,  600.,  550.,  500.,  450.,  400.,  350.,\n        300.,  250.,  200.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9706420a-f7ee-4342-8479-b0eb9c8b67e4' class='xr-section-summary-in' type='checkbox'  ><label for='section-9706420a-f7ee-4342-8479-b0eb9c8b67e4' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-91458870-475a-4b3c-a3c7-613b4f07488f' class='xr-index-data-in' type='checkbox'/><label for='index-91458870-475a-4b3c-a3c7-613b4f07488f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2019-06-08&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a7e1a609-bd2d-4813-b617-a3ce24fd7c6f' class='xr-index-data-in' type='checkbox'/><label for='index-a7e1a609-bd2d-4813-b617-a3ce24fd7c6f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-125.5, -124.5, -123.5, -122.5, -121.5, -120.5, -119.5, -118.5, -117.5,\n       -116.5, -115.5, -114.5, -113.5, -112.5, -111.5, -110.5, -109.5, -108.5,\n       -107.5, -106.5, -105.5, -104.5, -103.5, -102.5, -101.5, -100.5,  -99.5,\n        -98.5,  -97.5,  -96.5,  -95.5,  -94.5,  -93.5,  -92.5,  -91.5,  -90.5,\n        -89.5,  -88.5,  -87.5,  -86.5,  -85.5,  -84.5,  -83.5,  -82.5,  -81.5,\n        -80.5,  -79.5,  -78.5,  -77.5,  -76.5,  -75.5,  -74.5,  -73.5,  -72.5,\n        -71.5,  -70.5,  -69.5,  -68.5,  -67.5,  -66.5],\n      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e1a4e737-8dbc-429b-987b-659d91dc997b' class='xr-index-data-in' type='checkbox'/><label for='index-e1a4e737-8dbc-429b-987b-659d91dc997b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([23.5, 24.5, 25.5, 26.5, 27.5, 28.5, 29.5, 30.5, 31.5, 32.5, 33.5, 34.5,\n       35.5, 36.5, 37.5, 38.5, 39.5, 40.5, 41.5, 42.5, 43.5, 44.5, 45.5, 46.5,\n       47.5, 48.5, 49.5, 50.5],\n      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lev</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2b133a28-fc90-4236-b4af-0aeb728edc80' class='xr-index-data-in' type='checkbox'/><label for='index-2b133a28-fc90-4236-b4af-0aeb728edc80' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1000.0,  975.0,  950.0,  925.0,  900.0,  875.0,  850.0,  825.0,  800.0,\n        775.0,  750.0,  725.0,  700.0,  650.0,  600.0,  550.0,  500.0,  450.0,\n        400.0,  350.0,  300.0,  250.0,  200.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;lev&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-404ea758-fa3d-4584-994e-e2d6acad5838' class='xr-section-summary-in' type='checkbox'  checked><label for='section-404ea758-fa3d-4584-994e-e2d6acad5838' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>edge_heights</dd><dt><span>long_name :</span></dt><dd>edge_heights</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>fmissing_value :</span></dt><dd>1e+15</dd><dt><span>vmax :</span></dt><dd>1e+15</dd><dt><span>vmin :</span></dt><dd>-1e+15</dd></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"key":"EoNkHYx3SU"}],"key":"K77ByswXxZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U,V = geostrophic_wind(gph)","key":"wcmoTyZvhS"},{"type":"output","id":"D8XWQSdVan4mFBhZJLlrJ","data":[],"key":"J2B45XNfYx"}],"key":"uF9yJP4IQy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np.shape(U)","key":"MsCC5kJ6iF"},{"type":"output","id":"Q1ZSNnWpyHaTngwDT2rmP","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(1, 23, 28, 60)","content_type":"text/plain"}}}],"key":"byDD0Yi8ZO"}],"key":"TyGKyRMdsr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dataproj = ccrs. PlateCarree ()\n# # Plot projection\n# # The look you want for the view.\nplotproj = ccrs. PlateCarree ()\nfig=plt.figure(1, figsize=(15.,12.))\n\nax=plt.subplot(111,projection=plotproj)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.STATES, linewidth=0.5)\nplt.title(\"Geostrophic Wind Calculated Using Metpy\",size = 30)\nplt.quiver (new_data.lon, new_data.lat, U[0,12,:,:],V[0,12,:,:],minlength = 0.5,units='width')\n# plt.colorbar (orientation = \"horizontal\", pad=0.01).ax.tick_params(labelsize=20)\nplt. show ()","key":"JCgBSlx0dK"},{"type":"output","id":"p9T60VRKyjEKZwtxQrRmL","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/metpy-cookbook/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/metpy-cookbook/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_cultural/ne_50m_admin_1_states_provinces_lakes.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1200 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d05d2502a05cea71f5292a4e4aeb8a0d","path":"/metpy-cookbook/build/d05d2502a05cea71f5292a4e4aeb8a0d.png"}}}],"key":"qlIG3DHPuA"}],"key":"qjC9gu6rtX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"qx, qy = q_vector(U,V,T,p)","key":"HkbY3ec26a"},{"type":"output","id":"fa4ebO1_WvdvqXqjnZqx0","data":[],"key":"EDdVpOD5ck"}],"key":"IFwHOf7NPo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dataproj = ccrs. PlateCarree ()\n# # Plot projection\n# # The look you want for the view.\nplotproj = ccrs. PlateCarree ()\nfig=plt.figure(1, figsize=(15.,12.))\n\nax=plt.subplot(111,projection=plotproj)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.STATES, linewidth=0.5)\nplt.title(\"Q-vector Calculated Using Metpy\",size = 30)\n\nplt.contour(new_data.lon, new_data.lat,gaussian_filter(gph[0,12,:,:],1), colors = \"black\")\n# plt.contourf(new_data.lon, new_data.lat, new_data.OMEGA[0,12,:,:],levels =np.arange(-2,2,0.2),cmap = \"RdBu\", transform=dataproj,extend = \"both\" )\nplt.colorbar (orientation = \"horizontal\", pad=0.01).ax.tick_params(labelsize=20)\n# plt.colorbar (orientation = \"horizontal\", pad=0.01).ax.tick_params(labelsize=20)\nplt.quiver (new_data.lon, new_data.lat, qx[0,12,:,:],gaussian_filter(qy[0,12,:,:],0.7), color='blue',pivot='mid', \n          scale=1e-11, scale_units='inches',\n          transform=dataproj)\n\n# gaussian_filter(data, sigma)\nplt. show ()","key":"zRXDtlA2uc"},{"type":"output","id":"zUl4gwbJlvXA5uUUTm2yP","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1200 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"6a20c7ded11eb027168c04e4f1fe7533","path":"/metpy-cookbook/build/6a20c7ded11eb027168c04e4f1fe7533.png"}}}],"key":"l8LlqqQizR"}],"key":"qIUDyCURks"}],"key":"Jrfq0BX3Mo"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Differential Temperature Advection with NARR Data","url":"/notebooks/synoptic/differential-temperature-advection","group":"The MetPy Gallery"},"next":{"title":"Isentropic Analysis","url":"/notebooks/synoptic/isentropic-interpolation","group":"The MetPy Gallery"}}},"domain":"http://localhost:3000"}