{"version":2,"kind":"Notebook","sha256":"e9c94209ae82a2eb85d6282f89f10d90a4d6dbf1c8c98053d04a2a33d8f78050","slug":"notebooks.skewt.skew-t-analysis","location":"/notebooks/skewt/Skew-T_Analysis.ipynb","dependencies":[],"frontmatter":{"title":"Skew-T Analysis","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"MetPy Maintainers","given":"MetPy","family":"Maintainers"},"name":"MetPy Maintainers","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/metpy-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/projectpythia/metpy-cookbook/blob/main/notebooks/skewt/Skew-T_Analysis.ipynb","exports":[{"format":"ipynb","filename":"Skew-T_Analysis.ipynb","url":"/metpy-cookbook/build/Skew-T_Analysis-beae6a02568e3e23da7bc3c2c2f16cbd.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"cell_marker":"\"\"\""},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Create a Skew-T plot using remote data from University of Wyoming.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zcLZcLlW6p"}],"key":"ai2C8UM2YN"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This example uses example data from the University of Wyoming sounding\narchive for 12 UTC 31 October 2016 for Minneapolis, MN (MPX).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hPYezmluov"}],"key":"JJbA9udMfh"}],"key":"oOzIHZtSvD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Iu4b8oJq6G"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"XkJcFREE74"}],"key":"RbZK8kgaW7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nimport metpy.calc as mpcalc\nfrom metpy.cbook import get_test_data\nfrom metpy.plots import add_metpy_logo, SkewT\nfrom metpy.units import units\n\nfrom datetime import datetime\nfrom siphon.simplewebservice.wyoming import WyomingUpperAir","key":"EipdLRmcsa"},{"type":"output","id":"TY47edBqjZOkiE4GBHJao","data":[],"key":"QaVg2LFB4q"}],"key":"vctczWYsV4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Obtain Data and Format","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hX9Q1wdFJO"}],"identifier":"obtain-data-and-format","label":"Obtain Data and Format","html_id":"obtain-data-and-format","implicit":true,"key":"z5agQBGl2w"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This requires an internet connection to access the sounding data from a\nremote server at the University of Wyoming. ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MAa3Gw8ue0"},{"type":"break","key":"VJV6ymvp84"}],"key":"x4Q8Zi4hd1"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"First we will create variables for date, time and station. ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bQ5awyMu6N"},{"type":"break","key":"oPufbMa1Y7"},{"type":"text","value":"\nFormat: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"S8BBHYwXN6"},{"type":"inlineCode","value":"datetime(YYYY, MM, DD, HH)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"y6PRpbUCiA"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rsyeaKAX61"},{"type":"break","key":"Nbnb0aU8DL"}],"key":"ocHuHwZOcJ"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HzgsDSsJja"},{"type":"inlineCode","value":"station","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cukQb1Ic6c"},{"type":"text","value":" entry will need the be the three letter identifier of the station you want to look at. The National Center for Atmospheric Research (NCAR) ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"lFPqhZ7kQP"},{"type":"link","url":"https://ral.ucar.edu","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Research Applications Labratory","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HVU9mI0aum"}],"urlSource":"https://ral.ucar.edu","key":"Q5Bcifsq71"},{"type":"text","value":" (RAL) continously updates a ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"bO2w7yYmBe"},{"type":"link","url":"https://weather.rap.ucar.edu/surface/stations.txt","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"detailed list of all stations","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gGAzVTvKjq"}],"urlSource":"https://weather.rap.ucar.edu/surface/stations.txt","key":"dk6yCHmErv"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QKqJxutEB7"}],"key":"gfxpn0vKQb"}],"key":"yO9K28fboN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create variables for preferred date, time and station\npreferred_date = datetime(2016, 10, 26, 12)\nstation = 'MPX'","key":"WzQGsbuzMh"},{"type":"output","id":"pOzAG3LKnSqwKqcjqWKlz","data":[],"key":"wx6Pq9Iizl"}],"key":"jLnoJcCxm5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Read remote sounding data based on preferred_date and station\nsounding_data = WyomingUpperAir.request_data(preferred_date, station)","key":"Z1gmysvUBh"},{"type":"output","id":"lkd6JCJapznamZcuPudaB","data":[],"key":"VopzeeIwS6"}],"key":"oMxzhV6yza"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sounding_data","key":"PuXjFdQ5vs"},{"type":"output","id":"tRRo4drT7KS7_gyoZtriN","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"     pressure  height  temperature  dewpoint  direction  speed     u_wind  \\\n0       984.0     287          6.6       6.2      105.0    3.0  -2.897777   \n1       979.0     329          6.4       5.4      105.0    6.0  -5.795555   \n2       946.3     610          4.6       4.0      105.0   23.0 -22.216294   \n3       925.0     798          3.4       3.0      115.0   25.0 -22.657695   \n4       911.8     914          2.8       2.4      120.0   27.0 -23.382686   \n..        ...     ...          ...       ...        ...    ...        ...   \n123      20.0   26230        -55.9     -69.9      260.0   20.0  19.696155   \n124      19.5   26391        -55.1     -70.1      262.0   20.0  19.805361   \n125      16.6   27432        -57.1     -69.7      275.0   23.0  22.912478   \n126      15.0   28042        -58.3     -69.5      290.0   22.0  20.673238   \n127      14.8   28138        -58.5     -69.5        NaN    NaN        NaN   \n\n        v_wind station  station_number                time  latitude  \\\n0     0.776457     MPX           72649 2016-10-26 12:00:00     44.85   \n1     1.552914     MPX           72649 2016-10-26 12:00:00     44.85   \n2     5.952838     MPX           72649 2016-10-26 12:00:00     44.85   \n3    10.565457     MPX           72649 2016-10-26 12:00:00     44.85   \n4    13.500000     MPX           72649 2016-10-26 12:00:00     44.85   \n..         ...     ...             ...                 ...       ...   \n123   3.472964     MPX           72649 2016-10-26 12:00:00     44.85   \n124   2.783462     MPX           72649 2016-10-26 12:00:00     44.85   \n125  -2.004582     MPX           72649 2016-10-26 12:00:00     44.85   \n126  -7.524443     MPX           72649 2016-10-26 12:00:00     44.85   \n127        NaN     MPX           72649 2016-10-26 12:00:00     44.85   \n\n     longitude  elevation     pw  \n0       -93.56      287.0  24.32  \n1       -93.56      287.0  24.32  \n2       -93.56      287.0  24.32  \n3       -93.56      287.0  24.32  \n4       -93.56      287.0  24.32  \n..         ...        ...    ...  \n123     -93.56      287.0  24.32  \n124     -93.56      287.0  24.32  \n125     -93.56      287.0  24.32  \n126     -93.56      287.0  24.32  \n127     -93.56      287.0  24.32  \n\n[128 rows x 15 columns]","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>pressure</th>\n      <th>height</th>\n      <th>temperature</th>\n      <th>dewpoint</th>\n      <th>direction</th>\n      <th>speed</th>\n      <th>u_wind</th>\n      <th>v_wind</th>\n      <th>station</th>\n      <th>station_number</th>\n      <th>time</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>elevation</th>\n      <th>pw</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>984.0</td>\n      <td>287</td>\n      <td>6.6</td>\n      <td>6.2</td>\n      <td>105.0</td>\n      <td>3.0</td>\n      <td>-2.897777</td>\n      <td>0.776457</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>979.0</td>\n      <td>329</td>\n      <td>6.4</td>\n      <td>5.4</td>\n      <td>105.0</td>\n      <td>6.0</td>\n      <td>-5.795555</td>\n      <td>1.552914</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>946.3</td>\n      <td>610</td>\n      <td>4.6</td>\n      <td>4.0</td>\n      <td>105.0</td>\n      <td>23.0</td>\n      <td>-22.216294</td>\n      <td>5.952838</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>925.0</td>\n      <td>798</td>\n      <td>3.4</td>\n      <td>3.0</td>\n      <td>115.0</td>\n      <td>25.0</td>\n      <td>-22.657695</td>\n      <td>10.565457</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>911.8</td>\n      <td>914</td>\n      <td>2.8</td>\n      <td>2.4</td>\n      <td>120.0</td>\n      <td>27.0</td>\n      <td>-23.382686</td>\n      <td>13.500000</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>123</th>\n      <td>20.0</td>\n      <td>26230</td>\n      <td>-55.9</td>\n      <td>-69.9</td>\n      <td>260.0</td>\n      <td>20.0</td>\n      <td>19.696155</td>\n      <td>3.472964</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n    <tr>\n      <th>124</th>\n      <td>19.5</td>\n      <td>26391</td>\n      <td>-55.1</td>\n      <td>-70.1</td>\n      <td>262.0</td>\n      <td>20.0</td>\n      <td>19.805361</td>\n      <td>2.783462</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n    <tr>\n      <th>125</th>\n      <td>16.6</td>\n      <td>27432</td>\n      <td>-57.1</td>\n      <td>-69.7</td>\n      <td>275.0</td>\n      <td>23.0</td>\n      <td>22.912478</td>\n      <td>-2.004582</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n    <tr>\n      <th>126</th>\n      <td>15.0</td>\n      <td>28042</td>\n      <td>-58.3</td>\n      <td>-69.5</td>\n      <td>290.0</td>\n      <td>22.0</td>\n      <td>20.673238</td>\n      <td>-7.524443</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n    <tr>\n      <th>127</th>\n      <td>14.8</td>\n      <td>28138</td>\n      <td>-58.5</td>\n      <td>-69.5</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>MPX</td>\n      <td>72649</td>\n      <td>2016-10-26 12:00:00</td>\n      <td>44.85</td>\n      <td>-93.56</td>\n      <td>287.0</td>\n      <td>24.32</td>\n    </tr>\n  </tbody>\n</table>\n<p>128 rows × 15 columns</p>\n</div>","content_type":"text/html"}}}],"key":"k8sijCaT8J"}],"key":"soEv4egsfn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Assign Units","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"auDJ3Q0to2"}],"identifier":"assign-units","label":"Assign Units","html_id":"assign-units","implicit":true,"key":"u7LXWfPO2S"}],"key":"O2SGv5XsTK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will pull the data out of the example dataset into individual variables and assign units. This is explained in further detain in the Simple Sounding notebook and in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R586fWOcNj"},{"type":"link","url":"https://unidata.github.io/MetPy/latest/tutorials/unit_tutorial.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Metpy documentation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wlOXF8OtPH"}],"urlSource":"https://unidata.github.io/MetPy/latest/tutorials/unit_tutorial.html","key":"CBV9ZRvKxI"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qj2lOmdbs2"}],"key":"Fc7dhQLYDk"}],"key":"MQB1OFWlDz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pres = sounding_data['pressure'].values * units.hPa\ntemp = sounding_data['temperature'].values * units.degC\ndewpoint = sounding_data['dewpoint'].values * units.degC\nwind_speed = sounding_data['speed'].values * units.knots\nwind_dir = sounding_data['direction'].values * units.degrees\nu = sounding_data['u_wind'].values * units.knots\nv = sounding_data['v_wind'].values * units.knots","key":"rKxG7lOoRl"},{"type":"output","id":"KPBWzJEjR08Ev7N7G1nNf","data":[],"key":"nBsViGdEpd"}],"key":"gTr6CWULlw"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Sounding Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PrzUqVVzzG"}],"identifier":"create-sounding-plot","label":"Create Sounding Plot","html_id":"create-sounding-plot","implicit":true,"key":"i8MxFpPVGF"}],"visibility":"show","key":"nWtxuDXKWu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create figure and set size\nfig = plt.figure(figsize=(9, 9))\nskew = SkewT(fig, rotation=45)\n\n# Plot temperature and dewpoint lines\nskew.plot(pres, temp, 'red')\nskew.plot(pres, dewpoint, 'green')\n\n# Plot wind barbs\nmy_interval = np.arange(100, 1000, 25) * units('hPa')\nix = mpcalc.resample_nn_1d(pres, my_interval)\nskew.plot_barbs(pres[ix], u[ix], v[ix], y_clip_radius=0.001)\n\n# Improve labels and set axis limits\nskew.ax.set_xlabel('Temperature (\\N{DEGREE CELSIUS})')\nskew.ax.set_ylabel('Pressure (hPa)')\nskew.ax.set_ylim(1000, 100)\n\n# Add the relevant special lines\nskew.plot_dry_adiabats(t0=np.arange(233, 533, 10) * units.K, alpha=0.25, color='orangered')\nskew.plot_moist_adiabats(t0=np.arange(233, 400, 5) * units.K, alpha=0.25, color='tab:green')\nskew.plot_mixing_lines(pressure=np.arange(1000, 99, -25) * units.hPa, linestyle='dotted', color='tab:blue')\n\n# Add the MetPy logo!\nfig = plt.gcf()\nadd_metpy_logo(fig, 115, 100, size='small');\n\n# Add some descriptive titles\nplt.title('{} Sounding'.format(station), loc='left')\nplt.title('Valid Time: {}'.format(preferred_date), loc='right');","key":"DrpQukqWKe"},{"type":"output","id":"R-e7DQE6bGHzSzsLqVr1w","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/metpy-cookbook/lib/python3.13/site-packages/scipy/integrate/_ivp/base.py:23: UserWarning: Saturation mixing ratio is undefined for some requested pressure/temperature combinations. Total pressure must be greater than the water vapor saturation pressure for liquid water to be in equilibrium.\n  return np.asarray(fun(t, y), dtype=dtype)\n/home/runner/micromamba/envs/metpy-cookbook/lib/python3.13/site-packages/metpy/calc/thermo.py:1633: RuntimeWarning: invalid value encountered in power\n  * (mpconsts.nounit.T0 / temperature) ** heat_power\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c3fdf07993248f52ceaf4ce18ad65e73","path":"/metpy-cookbook/build/c3fdf07993248f52ceaf4ce18ad65e73.png"}}}],"key":"oAFd9RMXQO"}],"key":"RmfWuZIYuN"}],"key":"K0OB8IiI0G"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"MetPy Skew-T Cookbook","url":"/notebooks/skewt/foundational-sounding","group":"The MetPy Gallery"},"next":{"title":"Hodograph Inset","url":"/notebooks/skewt/skew-t-hodograph-inset","group":"The MetPy Gallery"}}},"domain":"http://localhost:3000"}