{"version":2,"kind":"Notebook","sha256":"90c5b2cac5769d5caaab8244b75c99db074cec9c5c784cef940f89ddc65347ce","slug":"notebooks.skewt.sounding-lcl-dataset","location":"/notebooks/skewt/Sounding_LCL_Dataset.ipynb","dependencies":[],"frontmatter":{"title":"Sounding as Dataset Example","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"MetPy Maintainers","given":"MetPy","family":"Maintainers"},"name":"MetPy Maintainers","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/metpy-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/projectpythia/metpy-cookbook/blob/main/notebooks/skewt/Sounding_LCL_Dataset.ipynb","exports":[{"format":"ipynb","filename":"Sounding_LCL_Dataset.ipynb","url":"/metpy-cookbook/build/Sounding_LCL_Dataset-87e638f692e831cf5a61fa95fc908c24.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Use MetPy to make a Skew-T LogP plot from an xarray Dataset after computing LCL parcel profile.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"qCqBnwF18m"}],"key":"ZN8vOzOnmG"}],"key":"yn3Uj8kLNd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OIkDar3ndA"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"J0Kblg3pXy"}],"key":"OfrVZCo1Ay"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nimport metpy.calc as mpcalc\nfrom metpy.cbook import get_test_data\nfrom metpy.plots import add_metpy_logo, SkewT\nfrom metpy.units import units","key":"FTvj5Eyros"},{"type":"output","id":"_v3eIJ1rbJzYcReeLib0V","data":[],"key":"QfVIbmUIbp"}],"key":"DsdseBbVB0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Obtain Data and Format","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mr0wh40I1N"}],"identifier":"obtain-data-and-format","label":"Obtain Data and Format","html_id":"obtain-data-and-format","implicit":true,"key":"YNMSDOdlsm"}],"key":"FXIxzEBF08"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Upper air data can be obtained using the siphon package, but for this example we will use some of MetPy’s sample data.\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OFw2nEu3P7"},{"type":"inlineCode","value":"as_file_obj=False), skiprows=5, usecols=[0, 1, 2, 3, 6, 7], names=col_names)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vn3ioSe8l2"},{"type":"text","value":" is necessary due to the formatting of the MetPy sample data. This formatting is not needed when using upper air data obtained via Siphon. Obtaining data with Siphon will be covered in a later notebook.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zkVyriw18u"}],"key":"ysM7YROvKH"}],"key":"BKLuw9kCLu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col_names = ['pressure', 'height', 'temperature', 'dewpoint', 'direction', 'speed']\n\nsounding_data = pd.read_fwf(get_test_data('20110522_OUN_12Z.txt', as_file_obj=False),\n                 skiprows=7, usecols=[0, 1, 2, 3, 6, 7], names=col_names)\n\n# Drop any rows with all not a number (NaN) values for temperature, dewpoint, and winds\nsounding_data = sounding_data.dropna(subset=('temperature', 'dewpoint', 'direction', 'speed'),\n               how='all').reset_index(drop=True)","key":"BXI1vb7aL5"},{"type":"output","id":"7RsSeO88RC_97VXr6lMRF","data":[],"key":"mG0ENXA5z1"}],"key":"AyygzoLMIN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Assign Units","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pQO5TtMMar"}],"identifier":"assign-units","label":"Assign Units","html_id":"assign-units","implicit":true,"key":"nAJmLubV7B"}],"key":"YlgF8p3PPJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will pull the data out of the example dataset into individual variables and assign units. This is explained in further detain in the Simple Sounding notebook and in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ljj0wfHDzU"},{"type":"link","url":"https://unidata.github.io/MetPy/latest/tutorials/unit_tutorial.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Metpy documentation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c6WSrKdYRe"}],"urlSource":"https://unidata.github.io/MetPy/latest/tutorials/unit_tutorial.html","key":"EXsamaR8JF"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SsUMh0RTlh"}],"key":"JtDmmwz4B3"}],"key":"Frf1fGbq0o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pres = sounding_data['pressure'].values * units.hPa\ntemp = sounding_data['temperature'].values * units.degC\ndewpoint = sounding_data['dewpoint'].values * units.degC\nwind_speed = sounding_data['speed'].values * units.knots\nwind_dir = sounding_data['direction'].values * units.degrees\nu, v = mpcalc.wind_components(wind_speed, wind_dir)\n\nlcl_ds = mpcalc.parcel_profile_with_lcl_as_dataset(pres, temp, dewpoint)","key":"sbHnNNY3fF"},{"type":"output","id":"lrjA3J0Gd4qMjOMNK0DZ6","data":[],"key":"CXD44K9AVA"}],"key":"mfKDTmpqTG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lcl_ds","key":"EEkDSX1kCT"},{"type":"output","id":"7sXmvEw2P7sg34K9TFx9-","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 2kB\nDimensions:              (isobaric: 71)\nCoordinates:\n  * isobaric             (isobaric) float64 568B 966.0 953.0 ... 104.0 100.0\nData variables:\n    ambient_temperature  (isobaric) float64 568B <Quantity([ 22.2         21....\n    ambient_dew_point    (isobaric) float64 568B <Quantity([ 21.          20....\n    parcel_temperature   (isobaric) float64 568B <Quantity([295.35       294....","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2kB\nDimensions:              (isobaric: 71)\nCoordinates:\n  * isobaric             (isobaric) float64 568B 966.0 953.0 ... 104.0 100.0\nData variables:\n    ambient_temperature  (isobaric) float64 568B &lt;Quantity([ 22.2         21....\n    ambient_dew_point    (isobaric) float64 568B &lt;Quantity([ 21.          20....\n    parcel_temperature   (isobaric) float64 568B &lt;Quantity([295.35       294....</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-849fb063-64d0-4eb6-8b7e-c7804000b3e3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-849fb063-64d0-4eb6-8b7e-c7804000b3e3' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>isobaric</span>: 71</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d1c12100-1b39-4806-8056-c80a2b8d7ac7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d1c12100-1b39-4806-8056-c80a2b8d7ac7' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>isobaric</span></div><div class='xr-var-dims'>(isobaric)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>966.0 953.0 949.0 ... 104.0 100.0</div><input id='attrs-c9ee29fd-37b5-4982-9037-28bc7c10f7b1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c9ee29fd-37b5-4982-9037-28bc7c10f7b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2019824d-8d19-462b-8d9e-0c2b4f2b7bc1' class='xr-var-data-in' type='checkbox'><label for='data-2019824d-8d19-462b-8d9e-0c2b4f2b7bc1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>hectopascal</dd><dt><span>standard_name :</span></dt><dd>air_pressure</dd></dl></div><div class='xr-var-data'><pre>array([966.      , 953.      , 948.996928, 936.9     , 925.      , 904.5     ,\n       896.      , 890.      , 886.      , 873.3     , 873.      , 850.      ,\n       846.      , 813.8     , 802.      , 785.      , 757.1     , 730.1     ,\n       700.      , 653.3     , 639.      , 606.      , 605.6     , 584.      ,\n       582.7     , 582.      , 577.      , 571.      , 561.      , 560.7     ,\n       539.4     , 539.      , 500.      , 478.9     , 453.      , 443.      ,\n       406.3     , 400.      , 389.3     , 327.3     , 313.4     , 300.      ,\n       286.      , 250.      , 249.      , 220.      , 210.      , 200.      ,\n       197.      , 196.5     , 190.      , 181.      , 173.      , 159.      ,\n       155.      , 154.2     , 150.      , 148.      , 146.9     , 146.      ,\n       142.      , 140.      , 137.      , 133.3     , 127.      , 126.      ,\n       120.9     , 111.      , 109.      , 104.      , 100.      ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d87ac8b4-8993-49a7-b75a-4af00c390eaa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d87ac8b4-8993-49a7-b75a-4af00c390eaa' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ambient_temperature</span></div><div class='xr-var-dims'>(isobaric)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([ 22.2         21.4   ...</div><input id='attrs-529d80c8-ac00-45cc-9e93-18250b9361f4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-529d80c8-ac00-45cc-9e93-18250b9361f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c79b4d03-9bfe-458a-ba5a-fb35157be51e' class='xr-var-data-in' type='checkbox'><label for='data-c79b4d03-9bfe-458a-ba5a-fb35157be51e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_temperature</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[22.2 21.4 21.250817178367882 20.8 20.4 19.3 18.8 20.0 22.2 23.2 23.2 22.0 21.8 19.2 18.2 16.5 13.7 10.9 7.6 2.3 0.6 -2.9 -2.9 -4.5 -4.4 -4.3 -3.7 -3.3 -3.9 -3.9 -6.3 -6.3 -11.1 -13.7 -17.1 -18.3 -23.9 -24.9 -26.6 -37.9 -40.7 -43.5 -46.3 -52.1 -52.3 -54.1 -55.9 -56.5 -56.5 -56.5 -56.5 -57.9 -56.9 -59.3 -58.9 -59.0 -59.5 -59.9 -59.2 -58.7 -57.9 -56.7 -56.5 -57.7 -59.8 -60.1 -61.0 -62.9 -64.3 -63.3 -64.3]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>degree_Celsius</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ambient_dew_point</span></div><div class='xr-var-dims'>(isobaric)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([ 21.          20.7   ...</div><input id='attrs-ec79feb1-754a-45a1-a080-50b1d48e1cd0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec79feb1-754a-45a1-a080-50b1d48e1cd0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a713223f-d412-437b-b3cb-017467747cb9' class='xr-var-data-in' type='checkbox'><label for='data-a713223f-d412-437b-b3cb-017467747cb9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>dew_point_temperature</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[21.0 20.7 20.650272392789294 20.5 20.4 19.3 18.8 20.0 19.0 13.3 13.2 6.0 3.8 -1.7 -3.8 -4.7 -6.2 -7.7 -9.4 -10.9 -11.4 -12.9 -12.9 -14.5 -14.4 -14.3 -24.7 -36.3 -31.9 -31.8 -27.4 -27.3 -29.1 -31.3 -34.1 -32.3 -37.0 -37.9 -39.3 -48.1 -50.3 -52.5 -55.3 -62.1 -62.3 -64.1 -65.9 -66.5 -66.5 -66.5 -66.5 -67.9 -66.9 -69.3 -68.9 -69.0 -69.5 -69.9 -69.2 -68.7 -67.9 -66.7 -66.5 -67.7 -69.8 -70.1 -71.0 -72.9 -73.3 -73.3 -74.3]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>degree_Celsius</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>parcel_temperature</span></div><div class='xr-var-dims'>(isobaric)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([295.35       294.2088...</div><input id='attrs-5e0cc8d6-ad9d-4d86-93c6-7c4195c13cd9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5e0cc8d6-ad9d-4d86-93c6-7c4195c13cd9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17b67674-2b1c-44d4-8616-84b0c607c534' class='xr-var-data-in' type='checkbox'><label for='data-17b67674-2b1c-44d4-8616-84b0c607c534' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>air_temperature_of_lifted_parcel</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[295.34999999999997 294.20887396170207 293.86103515373753 293.40521206315316 292.95554407657323 292.1640395964549 291.8293513447637 291.5907283271839 291.4305365455873 290.9159091531379 290.90364010741615 289.9469900668167 289.7772966055953 288.3731756081294 287.84076891081196 287.055760503624 285.718368797205 284.3609945120953 282.7666179014967 280.0992393764097 279.2291951602862 277.1124090882582 277.0857495928858 275.60736524897317 275.51586806388474 275.4664772987916 275.11115257875974 274.67878157696055 273.9431477951042 273.9207808159499 272.28590316054596 272.2542836334324 268.9902879694052 267.05712108492537 264.49509340735295 263.44349068473616 259.2382682685545 258.4553732522986 257.0799155092732 247.7674344589868 245.30616201311813 242.78121489195036 239.9724066136093 231.87060708454436 231.6262530291835 224.0491033990806 221.20535188821674 218.23531155566815 217.31880624803506 217.16488600117898 215.1329797206965 212.2217821874615 209.5339893277701 204.58647862314353 203.11181535717162 202.8134432576764 201.22764426849812 200.46081785234492 200.03577190878534 199.68624582217885 198.11321398226377 197.31441087391488 196.10033433574986 194.5758620029309 191.90760192899455 191.4752778236241 189.2309239009457 184.67135159335456 183.7149866858957 181.26768643759195 179.24835367555355]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>kelvin</td></tr></tbody></table></div></li></ul></div></li><li class='xr-section-item'><input id='section-b86961f4-1085-46a6-b904-dc3b3fe794f8' class='xr-section-summary-in' type='checkbox'  ><label for='section-b86961f4-1085-46a6-b904-dc3b3fe794f8' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>isobaric</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d2f2b216-169f-4e5e-9975-4f46247fcc24' class='xr-index-data-in' type='checkbox'/><label for='index-d2f2b216-169f-4e5e-9975-4f46247fcc24' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([            966.0,             953.0, 948.9969276195382,\n                   936.9,             925.0,             904.5,\n                   896.0,             890.0,             886.0,\n                   873.3,             873.0,             850.0,\n                   846.0,             813.8,             802.0,\n                   785.0,             757.1,             730.1,\n                   700.0,             653.3,             639.0,\n                   606.0,             605.6,             584.0,\n                   582.7,             582.0,             577.0,\n                   571.0,             561.0,             560.7,\n                   539.4,             539.0,             500.0,\n                   478.9,             453.0,             443.0,\n                   406.3,             400.0,             389.3,\n                   327.3,             313.4,             300.0,\n                   286.0,             250.0,             249.0,\n                   220.0,             210.0,             200.0,\n                   197.0,             196.5,             190.0,\n                   181.0,             173.0,             159.0,\n                   155.0,             154.2,             150.0,\n                   148.0,             146.9,             146.0,\n                   142.0,             140.0,             137.0,\n                   133.3,             127.0,             126.0,\n                   120.9,             111.0,             109.0,\n                   104.0,             100.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;isobaric&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a09c910b-d2b7-49cf-9ebb-f13d51bf1162' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a09c910b-d2b7-49cf-9ebb-f13d51bf1162' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"key":"P99oB7SZ3Y"}],"key":"DYXHONGLWi"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Sounding Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EZ7ZZI3aKU"}],"identifier":"create-sounding-plot","label":"Create Sounding Plot","html_id":"create-sounding-plot","implicit":true,"key":"l784Xe2K5r"}],"key":"guFFdjvrQ2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create figure and set size\nfig = plt.figure(figsize=(9, 9))\nskew = SkewT(fig, rotation=45)\n\n# Plot the data using the data from the xarray Dataset including the parcel temperature with\n# the LCL level included\nskew.plot(lcl_ds.isobaric, lcl_ds.ambient_temperature, 'red')\nskew.plot(lcl_ds.isobaric, lcl_ds.ambient_dew_point, 'green')\nskew.plot(lcl_ds.isobaric, lcl_ds.parcel_temperature.metpy.convert_units('degC'), 'black')\n\n# Plot wind barbs\nmy_interval = np.arange(100, 1000, 50) * units('hPa') #set spacing interval\nix = mpcalc.resample_nn_1d(pres, my_interval) #find nearest indices for chosen interval\nskew.plot_barbs(pres[ix], u[ix], v[ix], xloc=1) #plot values closest to chosen interval\n\n# Improve labels and set axis limits\nskew.ax.set_xlabel('Temperature (\\N{DEGREE CELSIUS})')\nskew.ax.set_ylabel('Pressure (hPa)')\nskew.ax.set_ylim(1000, 100)\nskew.ax.set_xlim(-40, 59)\n\n# Add the relevant special lines throughout the figure\nskew.plot_dry_adiabats(t0=np.arange(233, 533, 15) * units.K, alpha=0.25, color='orangered')\nskew.plot_moist_adiabats(t0=np.arange(233, 400, 10) * units.K, alpha=0.25, color='tab:green')\nskew.plot_mixing_lines(pressure=np.arange(1000, 99, -25) * units.hPa, linestyle='dotted', color='tab:blue')\n\n# Add the MetPy logo!\nfig = plt.gcf()\nadd_metpy_logo(fig, 115, 100, size='small');\n\n# Add titles\nplt.title('KOUN', loc='left')\nplt.title('2011-05-22 12 UTC', loc='right');","key":"Xyai5SllJZ"},{"type":"output","id":"R0M7OuCaSoAT6cNj67YdM","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/metpy-cookbook/lib/python3.13/site-packages/scipy/integrate/_ivp/base.py:23: UserWarning: Saturation mixing ratio is undefined for some requested pressure/temperature combinations. Total pressure must be greater than the water vapor saturation pressure for liquid water to be in equilibrium.\n  return np.asarray(fun(t, y), dtype=dtype)\n/home/runner/micromamba/envs/metpy-cookbook/lib/python3.13/site-packages/metpy/calc/thermo.py:1633: RuntimeWarning: invalid value encountered in power\n  * (mpconsts.nounit.T0 / temperature) ** heat_power\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"23b8f5a6cd7b75e9f1638fa4b9ab3f67","path":"/metpy-cookbook/build/23b8f5a6cd7b75e9f1638fa4b9ab3f67.png"}}}],"key":"iOoUiDKSIu"}],"key":"rpVn608CYs"}],"key":"H8eecL9Ap2"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Sounding Calculation Examples","url":"/notebooks/skewt/sounding-calculations","group":"The MetPy Gallery"},"next":{"title":"Sounding Plotter","url":"/notebooks/skewt/sounding-plotter","group":"The MetPy Gallery"}}},"domain":"http://localhost:3000"}