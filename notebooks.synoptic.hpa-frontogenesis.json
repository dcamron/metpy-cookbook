{"version":2,"kind":"Notebook","sha256":"61f0c8ba0a3ee0bbe404f926c9f57001a61ea5a994b24528741e70e977340cfa","slug":"notebooks.synoptic.hpa-frontogenesis","location":"/notebooks/synoptic/850hPa_Frontogenesis.ipynb","dependencies":[],"frontmatter":{"title":"850-hPa Geopotential Heights, Temperature, Frontogenesis, and Winds","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"MetPy Maintainers","given":"MetPy","family":"Maintainers"},"name":"MetPy Maintainers","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/metpy-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/projectpythia/metpy-cookbook/blob/main/notebooks/synoptic/850hPa_Frontogenesis.ipynb","exports":[{"format":"ipynb","filename":"850hPa_Frontogenesis.ipynb","url":"/metpy-cookbook/build/850hPa_Frontogenesis-ed3947cc12448c25fe55b6b64a6ce55f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"cell_marker":"\"\"\""},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Frontogenesis at 850-hPa with Geopotential Heights, Temperature, and\nWinds","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lrctiEKZpb"}],"key":"YX5IyLZ8Ed"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This example uses example data from the GFS analysis for 12 UTC 26\nOctober 2010 and uses xarray as the main read source with using MetPy to\ncalculate frontogenesis and wind speed with geographic plotting using\nCartopy for a CONUS view.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Wc24VzplzY"}],"key":"KCzIUV3ktt"}],"key":"CHJoCbAwDh"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"######################################################################"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import the needed modules.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZNi5flY5F2"}],"key":"yh3dFka6QN"}],"key":"rTKdpS3sBH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import cartopy.crs as ccrs\nimport cartopy.feature as cfeature\nimport matplotlib.pyplot as plt\nimport metpy.calc as mpcalc\nfrom metpy.units import units\nimport numpy as np\nimport xarray as xr","key":"ER99CWWz69"},{"type":"output","id":"Z6U5Jv3xwTExVMhaUrvsZ","data":[],"key":"oXPGUvFDj4"}],"key":"g2QlavpVzq"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"######################################################################"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Use Xarray to access GFS data from THREDDS resource and uses\nmetpy accessor to parse file to make it easy to pull data using\ncommon coordinate names (e.g., vertical) and attach units.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CuBfYzermQ"}],"key":"ZbdTnJrrYM"}],"key":"pWkc0Le15c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds = xr.open_dataset('https://thredds.ucar.edu/thredds/dodsC/casestudies/'\n                     'python-gallery/GFS_20101026_1200.nc').metpy.parse_cf()","key":"lrz0zlCYfC"},{"type":"output","id":"OQ6pqOIdR_pALLn1g_COk","data":[{"output_type":"stream","name":"stderr","text":"Could not find variable corresponding to the value of grid_mapping: LatLon_Projection\n"},{"output_type":"stream","name":"stderr","text":"Could not find variable corresponding to the value of grid_mapping: LatLon_Projection\n"},{"output_type":"stream","name":"stderr","text":"Could not find variable corresponding to the value of grid_mapping: LatLon_Projection\n"},{"output_type":"stream","name":"stderr","text":"Could not find variable corresponding to the value of grid_mapping: LatLon_Projection\n"},{"output_type":"stream","name":"stderr","text":"Could not find variable corresponding to the value of grid_mapping: LatLon_Projection\n"},{"output_type":"stream","name":"stderr","text":"Could not find variable corresponding to the value of grid_mapping: LatLon_Projection\n"},{"output_type":"stream","name":"stderr","text":"Could not find variable corresponding to the value of grid_mapping: LatLon_Projection\n"},{"output_type":"stream","name":"stderr","text":"Could not find variable corresponding to the value of grid_mapping: LatLon_Projection\n"},{"output_type":"stream","name":"stderr","text":"Could not find variable corresponding to the value of grid_mapping: LatLon_Projection\n"}],"key":"J3gaQc4ksr"}],"key":"nJS8vNEh3r"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"######################################################################"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Subset data based on latitude and longitude values, calculate potential\ntemperature for frontogenesis calculation.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NpxdsUYa4k"}],"key":"Ykui0HJIJM"}],"key":"wTvd0iO9xz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set subset slice for the geographic extent of data to limit download\nlon_slice = slice(200, 350)\nlat_slice = slice(85, 10)\n\n# Grab lat/lon values (GFS will be 1D)\nlats = ds.lat.sel(lat=lat_slice).values\nlons = ds.lon.sel(lon=lon_slice).values\n\nlevel = 850 * units.hPa\nhght_850 = ds.Geopotential_height_isobaric.metpy.sel(\n    vertical=level, lat=lat_slice, lon=lon_slice).squeeze()\ntmpk_850 = ds.Temperature_isobaric.metpy.sel(\n    vertical=level, lat=lat_slice, lon=lon_slice).squeeze()\nuwnd_850 = ds['u-component_of_wind_isobaric'].metpy.sel(\n    vertical=level, lat=lat_slice, lon=lon_slice).squeeze()\nvwnd_850 = ds['v-component_of_wind_isobaric'].metpy.sel(\n    vertical=level, lat=lat_slice, lon=lon_slice).squeeze()\n\n# Convert temperatures to degree Celsius for plotting purposes\ntmpc_850 = tmpk_850.metpy.convert_units('degC')\n\n# Calculate potential temperature for frontogenesis calculation\nthta_850 = mpcalc.potential_temperature(level, tmpk_850)\n\n# Get a sensible datetime format\nvtime = ds.time.data[0].astype('datetime64[ms]').astype('O')","key":"Q3yv69Dkec"},{"type":"output","id":"BC8WULKWvm0mK5H8zIKOR","data":[],"key":"HAsK94DOGR"}],"key":"feP0hXuYFM"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"######################################################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Calculate frontogenesis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sQ0L1XREJk"}],"identifier":"calculate-frontogenesis","label":"Calculate frontogenesis","html_id":"calculate-frontogenesis","implicit":true,"key":"jjnYMDZGaZ"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Frontogenesis calculation in MetPy requires temperature, wind\ncomponents, and grid spacings. First compute the grid deltas using MetPy\nfunctionality, then put it all together in the frontogenesis function.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"N2TIwOU0Wa"}],"key":"OjlErVuyUK"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Note: MetPy will give the output with SI units, but typically\nfrontogenesis (read: GEMPAK) output this variable with units of K per\n100 km per 3 h; a conversion factor is included here to use at plot time\nto reflect those units.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ZTUAVXewfh"}],"key":"FiyvItYp03"}],"key":"zNccNnJirD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fronto_850 = mpcalc.frontogenesis(thta_850, uwnd_850, vwnd_850)\n\n# A conversion factor to get frontogensis units of K per 100 km per 3 h\nconvert_to_per_100km_3h = 1000*100*3600*3","key":"CMyovYA2jx"},{"type":"output","id":"BNAcC3bgRCnbt15pbAqQE","data":[],"key":"xWacyEahaH"}],"key":"zDdshXbqQx"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"######################################################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Plotting Frontogenesis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EZcYW5BAFi"}],"identifier":"plotting-frontogenesis","label":"Plotting Frontogenesis","html_id":"plotting-frontogenesis","implicit":true,"key":"c8pxk3bMuN"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using a Lambert Conformal projection from Cartopy to plot 850-hPa\nvariables including frontogenesis.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"d54Xb7XcLq"}],"key":"wh8WHyQf5E"}],"key":"ZCESMkvkrk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set map projection\nmapcrs = ccrs.LambertConformal(central_longitude=-100, central_latitude=35,\n                               standard_parallels=(30, 60))\n\n# Set projection of the data (GFS is lat/lon)\ndatacrs = ccrs.PlateCarree()\n\n# Start figure and limit the graphical area extent\nfig = plt.figure(1, figsize=(14, 12))\nax = plt.subplot(111, projection=mapcrs)\nax.set_extent([-130, -72, 20, 55], ccrs.PlateCarree())\n\n# Add map features of Coastlines and States\nax.add_feature(cfeature.COASTLINE.with_scale('50m'))\nax.add_feature(cfeature.STATES.with_scale('50m'))\n\n# Plot 850-hPa Frontogenesis\nclevs_tmpc = np.arange(-40, 41, 2)\ncf = ax.contourf(lons, lats, fronto_850*convert_to_per_100km_3h,\n                 np.arange(-8, 8.5, 0.5), cmap=plt.cm.bwr, extend='both',\n                 transform=datacrs)\ncb = plt.colorbar(cf, orientation='horizontal', pad=0, aspect=50,\n                  extendrect=True)\ncb.set_label('Frontogenesis K / 100 km / 3 h')\n\n# Plot 850-hPa Temperature in Celsius\ncsf = ax.contour(lons, lats, tmpc_850, clevs_tmpc, colors='grey',\n                 linestyles='dashed', transform=datacrs)\nplt.clabel(csf, fmt='%d')\n\n# Plot 850-hPa Geopotential Heights\nclevs_850_hght = np.arange(0, 8000, 30)\ncs = ax.contour(lons, lats, hght_850, clevs_850_hght, colors='black',\n                transform=datacrs)\nplt.clabel(cs, fmt='%d')\n\n# Plot 850-hPa Wind Barbs only plotting every fifth barb\nwind_slice = (slice(None, None, 5), slice(None, None, 5))\nax.barbs(lons[wind_slice[0]], lats[wind_slice[1]],\n         uwnd_850[wind_slice].metpy.convert_units('kt').values,\n         vwnd_850[wind_slice].metpy.convert_units('kt').values,\n         color='black', transform=datacrs)\n\n# Plot some titles\nplt.title('GFS 850-hPa Geopotential Heights (m), Temp (C), and Winds',\n          loc='left')\nplt.title(f'Valid Time: {vtime}', loc='right')","key":"dLd8QOeS7I"},{"type":"output","id":"spEaIf9r-LUo4RqOawlrF","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1400x1200 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"29d4e48e95b3a9cbdb1c1a5325c06a5d","path":"/metpy-cookbook/build/29d4e48e95b3a9cbdb1c1a5325c06a5d.png"}}}],"key":"GLNN6VyYyY"}],"key":"DGVoFxQcrH"}],"key":"FEx82wc2Ot"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"500 hPa Vorticity Advection","url":"/notebooks/synoptic/hpa-vorticity-advection","group":"The MetPy Gallery"},"next":{"title":"QVector Example","url":"/notebooks/synoptic/hpa-qvectors","group":"The MetPy Gallery"}}},"domain":"http://localhost:3000"}